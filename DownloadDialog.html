<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <style>
      body {
        font-family: sans-serif;
      }
      .button {
        display: block;
        border: none;
        padding: 10px 20px;
        background-color: #00AEEF;
        color: #fff;
        font-weight: 700;
        border-radius: 50px;
        margin: 0 auto;
        cursor: pointer;
        transition: all 300ms;
      }
      .button:hover {
        background-color: #fff;
        color: #00AEEF;
        border: 1px solid #00AEEF;
      }
      .button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
    </style>
    <p>Click in the button down below to download the CSV with Semiclon separator:</p>
    <button id="download-button" class="button" onclick="downloadFile()">Download CSV</button>
    <p>*Important: Certify that your spreadsheet do not have any semicolon in the all content</p>
    <span id="url-link"></span>
    <script>
      function downloadFile() {
        document.querySelector('#download-button').disabled = true;
        document.querySelector('#download-button').innerHTML = "Downloading...";

        google.script.run.withSuccessHandler(function(obj) {
          window.open(obj.url, '_blank');
          document.querySelector('#download-button').innerHTML = "Thanks!";
        }).getCsvUrl();
      }
    </script>
  </body>
</html>
